<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal Scale of Value</title>
    <style>
        :root {
            --base-size: 280px;
            --text-color: #333;
            --accent-color: #333;
        }

        body {
            margin: 0;
            overflow: hidden;
            background-color: #f4f1ea;
            font-family: 'Georgia', serif;
            color: var(--text-color);
            height: 100vh;
            width: 100vw;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start; 
            transition: background-color 1.2s cubic-bezier(0.25, 1, 0.5, 1);
        }

        /* --- UI OVERLAYS --- */
        
        .header {
            position: absolute;
            top: 20px;
            text-align: center;
            z-index: 90;
            width: 100%;
        }
        h1 { margin: 0; font-size: 2.2rem; letter-spacing: 3px; text-transform: uppercase; opacity: 0.9; }
        .subtitle { font-family: sans-serif; opacity: 0.6; font-size: 0.9rem; margin-top: 5px; letter-spacing: 1px; }

        /* CATEGORY TABS */
        .category-tabs {
            margin-top: 15px;
            display: inline-flex;
            background: rgba(255,255,255,0.5);
            backdrop-filter: blur(10px);
            padding: 5px;
            border-radius: 30px;
            gap: 5px;
            pointer-events: all;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        .tab-btn {
            background: transparent;
            border: none;
            padding: 8px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-family: sans-serif;
            font-size: 0.85rem;
            font-weight: bold;
            color: #666;
            transition: all 0.2s ease;
        }
        .tab-btn:hover { background: rgba(0,0,0,0.05); color: #333; }
        .tab-btn.active { 
            background: #333; 
            color: white; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        /* Top Right Controls */
        .top-controls {
            position: absolute;
            top: 30px;
            right: 40px;
            z-index: 200;
            display: flex;
            gap: 15px;
        }

        .control-btn {
            background: rgba(255,255,255,0.6);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(0,0,0,0.1);
            border-radius: 30px;
            padding: 10px 20px;
            font-family: sans-serif;
            font-size: 0.9rem;
            font-weight: bold;
            color: #555;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .control-btn:hover { background: white; transform: translateY(-2px); }
        .icon-btn { width: 40px; height: 40px; border-radius: 50%; padding: 0; justify-content: center; font-family: 'Georgia', serif; font-size: 1.2rem; }

        /* Navigation Arrows */
        .controls {
            position: absolute;
            bottom: 30px;
            display: flex;
            gap: 50px; /* Wider gap */
            z-index: 100;
        }
        .nav-btn {
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0,0,0,0.1);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            padding-bottom: 4px; 
        }
        .nav-btn:hover { transform: scale(1.15); background: white; }
        .nav-btn:disabled { opacity: 0.2; cursor: default; transform: none; }

        /* MODAL */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.4);
            backdrop-filter: blur(5px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        .modal-overlay.open { opacity: 1; pointer-events: all; }
        .modal-content {
            background: white;
            width: 90%;
            max-width: 500px;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.2);
            transform: translateY(20px);
            transition: transform 0.3s ease;
            font-family: sans-serif;
            color: #333;
        }
        .modal-overlay.open .modal-content { transform: translateY(0); }
        .modal-title { font-family: 'Georgia', serif; font-size: 1.8rem; margin-bottom: 15px; }
        .modal-text { line-height: 1.6; color: #555; margin-bottom: 15px; }
        .modal-close {
            position: absolute;
            top: 20px; right: 20px;
            background: none; border: none; font-size: 1.5rem; cursor: pointer; opacity: 0.5;
        }
        .modal-close:hover { opacity: 1; }

        /* STAGE */
        .stage {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            perspective: 1200px;
        }

        .item {
            position: absolute;
            left: 50%;
            /* FIX 1: Lifted to 38% to create vertical space for text */
            top: 38%; 
            margin-left: calc(var(--base-size) / -2); 
            margin-top: calc(var(--base-size) / -2);  
            width: var(--base-size); 
            height: var(--base-size);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            transform-style: preserve-3d; 
            transition: transform 0.8s cubic-bezier(0.2, 0.8, 0.2, 1), opacity 0.8s ease;
        }

        .visual {
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.15), 0 0 0 1px rgba(0,0,0,0.05);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 30px;
            box-sizing: border-box;
            transform-style: preserve-3d;
            transition: transform 0.1s ease-out;
            will-change: transform;
            backface-visibility: hidden;
        }

        .visual::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            border-radius: 20px;
            background: linear-gradient(125deg, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0) 40%);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .visual img {
            max-width: 85%;
            max-height: 85%;
            object-fit: contain;
            filter: drop-shadow(0 10px 20px rgba(0,0,0,0.15));
            transform: translateZ(40px); 
        }

        .label {
            position: absolute;
            /* FIX 2: Adjusted bottom spacing so text floats higher */
            bottom: -220px; 
            text-align: center;
            width: 500px;
            pointer-events: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            transform: translateZ(0); 
        }
        
        .name { font-size: 1.8rem; font-weight: 800; display: block; margin-bottom: 5px; letter-spacing: -0.5px;}
        .worth { font-family: sans-serif; color: #555; font-size: 1.1rem; letter-spacing: 0.5px; transition: color 0.3s;}
        
        .description { 
            margin-top: 10px; 
            font-size: 1rem; 
            opacity: 0; 
            transform: translateY(-10px);
            transition: all 0.6s 0.2s; 
            line-height: 1.4;
            max-width: 80%;
        }

        .comparison-fact {
            background: rgba(255, 255, 255, 0.4);
            padding: 10px 20px;
            border-radius: 30px;
            margin-top: 15px;
            font-size: 0.9rem;
            font-weight: 500;
            font-style: italic;
            color: #333;
            border: 1px solid rgba(255,255,255,0.4);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s 0.4s;
            max-width: 350px;
            backdrop-filter: blur(8px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .anchor-item .visual {
            background: rgba(255,255,255,0.85);
            border: 2px dashed rgba(0,0,0,0.1);
        }
        
        /* VISIBILITY STATES & SCALING FIX */
        .item.focus { z-index: 100; opacity: 1; transform: translateX(0) scale(1); }
        .item.focus .description, .item.focus .comparison-fact { opacity: 1; transform: translateY(0); }
        .item.focus .visual::after { opacity: 1; } 

        .item.prev {
            z-index: 10; opacity: 0.1; filter: blur(3px) grayscale(100%);
            /* Anchored Right (grows left) */
            transform-origin: center right; 
            /* FIX 3: Increased spacing to 160% to prevent overlap */
            transform: translateX(-160%) scale(var(--scale)) rotateY(15deg); 
        }

        .item.next {
            z-index: 10; opacity: 0.1; filter: blur(3px) grayscale(100%);
            /* Anchored Left (grows right) */
            transform-origin: center left; 
            /* FIX 3: Increased spacing to 160% to prevent overlap */
            transform: translateX(160%) scale(var(--scale)) rotateY(-15deg);
        }
        .item.hidden { opacity: 0; pointer-events: none; transform: scale(0); }
    </style>
</head>
<body>

    <div class="top-controls">
        <button id="btn-currency" class="control-btn" title="Toggle Currency">USD ($)</button>
        <button id="btn-info" class="control-btn icon-btn" title="Methodology">i</button>
    </div>

    <div class="header">
        <h1>SCALE OF VALUE</h1>
        <div class="subtitle">Interactive Net Worth Visualization</div>
        
        <div class="category-tabs">
            <button onclick="switchCategory('tech')" class="tab-btn active" id="tab-tech">Tech Giants</button>
            <button onclick="switchCategory('history')" class="tab-btn" id="tab-history">Empires</button>
            <button onclick="switchCategory('nations')" class="tab-btn" id="tab-nations">Nations (GDP)</button>
        </div>
    </div>

    <div class="stage" id="stage"></div>

    <div class="controls">
        <button id="btn-prev" class="nav-btn">‚Üê</button>
        <button id="btn-next" class="nav-btn">‚Üí</button>
    </div>

    <div class="modal-overlay" id="modal-overlay">
        <div class="modal-content">
            <button class="modal-close" id="modal-close">√ó</button>
            <h2 class="modal-title">Methodology</h2>
            <p class="modal-text"><strong>Tech:</strong> Market Cap data from Yahoo Finance (Q1 2025).</p>
            <p class="modal-text"><strong>History:</strong> Inflation-adjusted estimates. "Dutch East India" value is based on its 1637 peak. "Mansa Musa" is based on historical gold holdings estimates.</p>
            <p class="modal-text"><strong>Nations:</strong> 2024 GDP data sourced from World Bank and IMF projections.</p>
            <p class="modal-text" style="font-size: 0.85rem; opacity: 0.7;"><em>Note: Values are simplified for educational comparison.</em></p>
        </div>
    </div>

    <script>
        // --- CONFIG ---
        const currencies = {
            USD: { rate: 1, symbol: '$', name: 'USD' },
            EUR: { rate: 0.95, symbol: '‚Ç¨', name: 'EUR' },
            GBP: { rate: 0.82, symbol: '¬£', name: 'GBP' }
        };
        let currentCurrency = 'USD';
        let currentIndex = 0;

        // --- DATASETS ---
        const datasets = {
            tech: [
                { name: "GoPro", worth: 0.2, color: "#00AEEF", bg: "#eef9fd", desc: "Action cameras.", comparison: "Budget of 'Black Panther'.", img: "https://upload.wikimedia.org/wikipedia/commons/c/c3/GoPro_logo.svg" },
                { name: "Duolingo", worth: 13, color: "#58CC02", bg: "#f0fae6", desc: "Language learning.", comparison: "Cost of James Webb Telescope.", img: "https://upload.wikimedia.org/wikipedia/commons/1/15/Duolingo_logo.svg" },
                { name: "Spotify", worth: 80, color: "#1DB954", bg: "#e8f8ed", desc: "Music streaming.", comparison: "GDP of Sri Lanka.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/19/Spotify_logo_without_text.svg/512px-Spotify_logo_without_text.svg.png" },
                { name: "The ISS", worth: 150, color: "#888888", bg: "#e6e6fa", desc: "International Space Station.", comparison: "Most expensive object ever built.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/f/f2/ISS_spacecraft_model_1.png/640px-ISS_spacecraft_model_1.png", isAnchor: true },
                { name: "Netflix", worth: 380, color: "#E50914", bg: "#fce8e9", desc: "Streaming pioneer.", comparison: "Cost of Apollo Program.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/Netflix_2015_logo.svg/512px-Netflix_2015_logo.svg.png" },
                { name: "Meta", worth: 1600, color: "#0668E1", bg: "#e6f0fc", desc: "Facebook/Instagram.", comparison: "GDP of Australia.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/Meta_Platforms_Inc._logo.svg/512px-Meta_Platforms_Inc._logo.svg.png" },
                { name: "Microsoft", worth: 3500, color: "#00A4EF", bg: "#e5f6fd", desc: "Windows & Cloud.", comparison: "Give every human $430.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/9/96/Microsoft_logo_%282012%29.svg/512px-Microsoft_logo_%282012%29.svg.png" },
                { name: "NVIDIA", worth: 4500, color: "#76B900", bg: "#f1f8e6", desc: "AI Hardware.", comparison: "Larger than UK Economy.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/a/a4/NVIDIA_logo.svg/512px-NVIDIA_logo.svg.png" }
            ],
            history: [
                { name: "Mansa Musa", worth: 400, color: "#D4AF37", bg: "#fcf6e0", desc: "14th Century Ruler of Mali.", comparison: "Wealthiest individual in history.", img: "https://upload.wikimedia.org/wikipedia/commons/1/18/Flag_of_the_Mali_Empire.svg" },
                { name: "South Sea Co.", worth: 4500, color: "#1a2f4b", bg: "#eef2f5", desc: "1720 British Bubble.", comparison: "Crash caused a national crisis.", img: "https://upload.wikimedia.org/wikipedia/commons/2/2e/Arms_of_the_South_Sea_Company.svg" },
                { name: "Mississippi Co.", worth: 6500, color: "#5d3a1a", bg: "#f5f0eb", desc: "1720 French Monopoly.", comparison: "Controlled all French colonial trade.", img: "https://upload.wikimedia.org/wikipedia/commons/1/1b/Armoiries_de_la_Compagnie_des_Indes_Orientales.jpg" },
                { name: "Dutch East India", worth: 7900, color: "#d15b2e", bg: "#faebe6", desc: "The 'VOC' (1602-1799).", comparison: "More valuable than Apple + Microsoft.", img: "https://upload.wikimedia.org/wikipedia/commons/5/5e/VOC.svg" }
            ],
            nations: [
                { name: "Iceland", worth: 33, color: "#003897", bg: "#e6f0ff", desc: "GDP of Iceland.", comparison: "Wealthy, but tiny compared to Tech.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/c/ce/Flag_of_Iceland.svg/640px-Flag_of_Iceland.svg.png" },
                { name: "New Zealand", worth: 250, color: "#00247D", bg: "#e6ecfa", desc: "GDP of New Zealand.", comparison: "Roughly the size of Netflix.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/Flag_of_New_Zealand.svg/640px-Flag_of_New_Zealand.svg.png" },
                { name: "Russia", worth: 2170, color: "#D52B1E", bg: "#fae6e6", desc: "GDP of Russian Fed.", comparison: "Smaller than Microsoft.", img: "https://upload.wikimedia.org/wikipedia/en/thumb/f/f3/Flag_of_Russia.svg/640px-Flag_of_Russia.svg.png" },
                { name: "Japan", worth: 4200, color: "#BC002D", bg: "#fff0f0", desc: "GDP of Japan.", comparison: "4th largest economy; rivals NVIDIA.", img: "https://upload.wikimedia.org/wikipedia/en/thumb/9/9e/Flag_of_Japan.svg/640px-Flag_of_Japan.svg.png" }
            ]
        };

        let currentData = datasets.tech; 

        // --- CORE LOGIC ---
        function getFormattedValue(billionsUSD) {
            const config = currencies[currentCurrency];
            const value = billionsUSD * config.rate;
            const symbol = config.symbol;
            if (value < 1) return `${symbol}${(value * 1000).toFixed(0)} Million`;
            if (value >= 1000) return `${symbol}${(value / 1000).toFixed(1)} Trillion`;
            return `${symbol}${value.toFixed(0)} Billion`;
        }

        function switchCategory(cat) {
            // Update Data
            currentData = datasets[cat];
            currentIndex = 0;
            
            // Update UI
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`tab-${cat}`).classList.add('active');

            init();
        }

        function init() {
            const stage = document.getElementById('stage');
            stage.innerHTML = ''; // Clear Stage

            currentData.forEach((item, index) => {
                const el = document.createElement('div');
                el.className = 'item hidden'; 
                if (item.isAnchor) el.classList.add('anchor-item');
                el.id = `item-${index}`;
                
                el.innerHTML = `
                    <div class="visual" id="visual-${index}" style="border-top: 6px solid ${item.color};">
                        <img src="${item.img}" alt="${item.name}">
                    </div>
                    <div class="label">
                        <span class="name">${item.name}</span>
                        <span class="worth" id="worth-${index}">${getFormattedValue(item.worth)}</span>
                        <div class="description">${item.desc}</div>
                        <div class="comparison-fact">üí° ${item.comparison}</div>
                    </div>
                `;
                stage.appendChild(el);
            });
            updateView();
        }

        function updateView() {
            const focusedItem = currentData[currentIndex];
            document.body.style.backgroundColor = focusedItem.bg;

            currentData.forEach((item, index) => {
                const el = document.getElementById(`item-${index}`);
                const visual = document.getElementById(`visual-${index}`);
                
                if(visual) visual.style.transform = `rotateX(0) rotateY(0)`;

                const scaleRatio = item.worth / focusedItem.worth;
                el.style.setProperty('--scale', scaleRatio);

                el.classList.remove('focus', 'prev', 'next', 'hidden');

                if (index === currentIndex) el.classList.add('focus');
                else if (index === currentIndex - 1) el.classList.add('prev');
                else if (index === currentIndex + 1) el.classList.add('next');
                else el.classList.add('hidden');
            });

            document.getElementById('btn-prev').disabled = currentIndex === 0;
            document.getElementById('btn-next').disabled = currentIndex === currentData.length - 1;
        }

        // --- LISTENERS ---
        document.getElementById('btn-currency').addEventListener('click', () => {
            if (currentCurrency === 'USD') currentCurrency = 'EUR';
            else if (currentCurrency === 'EUR') currentCurrency = 'GBP';
            else currentCurrency = 'USD';

            const config = currencies[currentCurrency];
            document.getElementById('btn-currency').innerText = `${config.name} (${config.symbol})`;
            
            // Update labels without re-init
            currentData.forEach((item, index) => {
                const el = document.getElementById(`worth-${index}`);
                if(el) el.innerText = getFormattedValue(item.worth);
            });
        });

        const modal = document.getElementById('modal-overlay');
        document.getElementById('btn-info').addEventListener('click', () => modal.classList.add('open'));
        document.getElementById('modal-close').addEventListener('click', () => modal.classList.remove('open'));
        modal.addEventListener('click', (e) => { if(e.target===modal) modal.classList.remove('open'); });

        document.getElementById('btn-next').addEventListener('click', () => {
            if (currentIndex < currentData.length - 1) { currentIndex++; updateView(); }
        });
        document.getElementById('btn-prev').addEventListener('click', () => {
            if (currentIndex > 0) { currentIndex--; updateView(); }
        });

        // 3D Tilt
        document.addEventListener('mousemove', (e) => {
            const focused = document.querySelector('.item.focus .visual');
            if (!focused) return;
            const rect = focused.getBoundingClientRect();
            const x = e.clientX - (rect.left + rect.width / 2);
            const y = e.clientY - (rect.top + rect.height / 2);
            focused.style.transform = `rotateX(${(y / window.innerHeight) * -40}deg) rotateY(${(x / window.innerWidth) * 40}deg)`;
        });
        document.addEventListener('mouseleave', () => {
             const focused = document.querySelector('.item.focus .visual');
             if(focused) focused.style.transform = `rotateX(0) rotateY(0)`;
        });

        init();
    </script>
</body>
</html>
